# Review History: 018-structured-problem-solving

## Stage 1: Spec-Reviewer Review - Iteration 1 - 2026-02-07T12:15:00Z

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Needs Revision (3 blockers, 7 warnings, 2 suggestions)

**Issues:**
- [blocker] [dependency] Mermaid MCP tool not configured in project .mcp.json (at: BS-5)
  Suggestion: Use inline Mermaid code blocks instead of MCP tool dependency
- [blocker] [format] Mind map base64 PNG output not renderable in standard markdown (at: BS-5)
  Suggestion: Use fenced mermaid code blocks written directly to markdown
- [blocker] [testability] Acceptance criteria lack Given/When/Then format (at: Requirements Traceability)
  Suggestion: Rewrite in Given/When/Then structure per reviewing-artifacts standard
- [warning] [ambiguity] "Stage 6" reference in C3 could mean brainstorming Stage 6 or Step 6 (at: C3)
  Suggestion: Clarify as "Stage 6 READINESS CHECK"
- [warning] [mechanism] Skill-loading mechanism unclear — how does brainstorming read the skill? (at: C2 Step 7)
  Suggestion: Specify Read tool usage for SKILL.md and reference files
- [warning] [scope] validate.sh wording implies no validation exists for skills (at: Out of Scope)
  Suggestion: Clarify that validate.sh already covers agent frontmatter
- [warning] [gap] "Other" type path not fully defined (at: C2 Step 7)
  Suggestion: Define what decomposition method and review criteria apply
- [warning] [mechanism] Mind map update mechanism on refinement loops unclear (at: BS-5)
  Suggestion: Specify that entire Structured Analysis is regenerated
- [warning] [gap] Multi-type problem handling not specified (at: C2 Step 6)
  Suggestion: Define behavior when problem spans types
- [warning] [gap] Mid-brainstorm framework loading not addressed (at: BS-1)
  Suggestion: Clarify that loop back via Stage 7 is the path

**Changes Made:**
- Changed mind map approach from MCP tool dependency to inline Mermaid code blocks (addresses blockers 1 & 2)
- Rewrote all acceptance criteria in Given/When/Then format (addresses blocker 3)
- Clarified Stage 6 reference as "Stage 6 READINESS CHECK" in C3 (addresses warning 1)
- Specified Read tool usage for SKILL.md and reference files in Step 7 (addresses warning 2)
- Clarified validate.sh out-of-scope wording (addresses warning 3)
- Defined "Other" type behavior: SCQA + generic issue tree, universal review criteria only (addresses warning 4)
- Specified full Structured Analysis regeneration on refinement loops (addresses warning 5)
- Added Open Question resolution for multi-type: user picks primary (addresses warning 6)
- Added Open Question resolution for mid-brainstorm loading: loop back via Stage 7 (addresses warning 7)

---

## Stage 2: Phase Review - 2026-02-07T12:20:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved (3 warnings, 2 suggestions)

**Issues:**
- [warning] [ambiguity] Exit condition wording ambiguous — "all items answered" unclear whether Steps 6-8 are included (at: C2, "Exit condition unchanged")
  Suggestion: Clarify Steps 6-8 run after original exit condition is satisfied
- [warning] [traceability] FR-5 maps to "Steps 7-8" but Step 8 is metadata write, not framework loading (at: Requirements Traceability, FR-5)
  Suggestion: Split or remap
- [warning] [completeness] "Other" type not mentioned in C3 reviewer criteria table (at: C3 type-specific criteria table)
  Suggestion: Add note that custom types use universal criteria only
- [suggestion] [detail] BS-3 doesn't specify exact warning text (at: BS-3)
  Suggestion: Add example warning strings
- [suggestion] [gap] Behavior when user changes problem type on refinement loop not specified (at: C2 Step 7 / BS-5)
  Suggestion: Add note about full regeneration or removal of Structured Analysis

---

## Design Review - Iteration 1 - 2026-02-07T12:55:00Z

**Reviewer:** design-reviewer (skeptic)
**Decision:** Needs Revision (4 blockers, 6 warnings, 2 notes)

**Issues:**
- [blocker] [completeness] 5 problem types never enumerated in design (at: Component 2: Reference Files)
  Challenge: What are the 5 types and their mappings?
- [blocker] [completeness] Steps 6-8 insertion point ambiguous relative to exit condition (at: Component 3, Change 1)
  Challenge: Where exactly do Steps 6-8 go?
- [blocker] [completeness] Cross-skill Read pattern is novel and file paths unspecified (at: Interface 1)
  Challenge: What is the exact Read tool invocation path?
- [blocker] [consistency] Skill naming "structured-problem-solving" may not follow gerund convention (at: Component 1)
  Challenge: Does it satisfy the naming convention?
- [warning] [completeness] Reviewer criteria table columns undefined (at: Component 4, Change 2)
- [warning] [consistency] Stage 6 dispatch changes from file-path to inline content without justification (at: Interface 2)
- [warning] [completeness] Brainstorming SKILL.md final line count not verified (at: File Change Summary)
- [warning] [assumptions] AskUserQuestion "built-in free text" may not exist as assumed (at: TD-5)
- [warning] [completeness] "Skip" behavior path not fully specified (at: Data Flow)
- [warning] [completeness] Backward compatibility for existing PRDs not addressed (at: Component 4)

**Changes Made:**
- Added Problem Type Taxonomy section with full 5-type enumeration including decomposition methods and criteria (addresses blocker 1)
- Clarified Steps 6-8 insertion: after exit condition line 62, before Stage 2 separator line 64 (addresses blocker 2)
- Specified cross-skill Read using ${CLAUDE_PLUGIN_ROOT} base path, documented as novel pattern (addresses blocker 3)
- Added naming note: "structured-problem-solving" ends with gerund "solving" (addresses blocker 4)
- Defined criteria table as 4 columns: Problem Type, Check 1, Check 2, Check 3 (addresses warning 1)
- Added justification for file-path to inline content change; matches design command pattern (addresses warning 2)
- Added line budget check: 399 + ~60 + ~15 = ~474, under 500 limit (addresses warning 3)
- Clarified AskUserQuestion always provides "Other" free-text option to user (addresses warning 4)
- Specified "Skip" to type "none", Steps 7 body skipped entirely (addresses warning 5)
- Added backward compatibility note: missing Problem Type to universal criteria only (addresses warning 6)

---

## Handoff Review - 2026-02-07T13:00:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved (3 warnings, 2 suggestions)

**Issues:**
- [warning] Line budget headroom is tight (~474 est vs 500 limit, ~26 lines) (at: File Change Summary)
  Suggestion: Count actual lines during implementation; flag if approaching 495+
- [warning] Design presents 6 AskUserQuestion options (not 7 per spec FR-4); relies on built-in "Other" (at: TD-5)
  Suggestion: Verify AskUserQuestion auto-provides "Other" option; if not, add explicit 7th option
- [warning] PRD UC-3 says "load framework at any point" but spec/design restrict to Stage 1 Step 7 only (at: Data Flow)
  Suggestion: Follow design/spec, not PRD edge case
- [suggestion] Use exact text "prompt: PRD file path + request for JSON response" at line 169 as search target (at: Component 3, Change 2)
- [suggestion] Regeneration on loop-back should replace existing Structured Analysis, not duplicate (at: Interface 4)

---

## Stage 1: Plan-Reviewer Review - Iteration 1 - 2026-02-07T13:15:00Z

**Reviewer:** plan-reviewer (skeptic)
**Decision:** Needs Revision (3 blockers, 5 warnings, 2 notes)

**Issues:**
- [blocker] [assumption] ${CLAUDE_PLUGIN_ROOT} only used in hooks.json, never in SKILL.md Read calls — cross-skill Read mechanism unproven (at: Step 0b and Step 4, Change 1)
- [blocker] [assumption] How LLM determines filesystem path to another skill's directory at runtime not explained (at: Step 4, Change 1)
- [blocker] [tdd-order] No "Why this item" or "Why this order" rationale per step (at: All steps)
- [warning] [failure-mode] Step 5a trim plan is vague — doesn't specify what gets cut or where it moves (at: Step 5a)
- [warning] [dependency] Criteria table duplicated in two files with no drift prevention (at: Step 1d, Step 3 Change 2)
- [warning] [assumption] Spec FR-4 vs Design TD-5 option count not reconciled (at: Step 0a, Step 4 Change 1)
- [warning] [consistency] PRD FR-9 says use MCP tool but plan uses inline Mermaid without noting divergence (at: Step 2, Step 4 Change 3)
- [warning] [consistency] Implementation order diagram shows sequential but dependency graph shows Step 2 and 3 are parallel (at: Implementation Order vs Dependencies)
- [note] validate.sh checks for "Use when" in description — should confirm planned description passes (at: Step 2)
- [note] Search target for Stage 6 dispatch may include leading "- " prefix (at: Step 4 Change 2)

**Changes Made:**
- Replaced ${CLAUDE_PLUGIN_ROOT} with Base directory path mechanism from skill invocation context (addresses blocker 1)
- Explained cross-skill Read: derive sibling path from Base directory by replacing `skills/brainstorming` with `skills/structured-problem-solving` (addresses blocker 2)
- Added "Why this step" and "Why this order" rationale to every step (addresses blocker 3)
- Added concrete trim plan: 3 tiers of compression with estimated savings (addresses warning 1)
- Added duplication note as accepted trade-off with Step 5b verification (addresses warning 2)
- Added explicit reconciliation: either outcome (built-in or explicit Other) satisfies FR-4 (addresses warning 3)
- Added Design Divergences table noting PRD FR-9, UC-3, and FR-4 deviations with rationale (addresses warning 4)
- Updated implementation order diagram to show Steps 2 and 3 as parallel (addresses warning 5)
- Added validate.sh description checks to Step 2 and Step 6a (addresses note 1)
- Added leading "- " to search target text (addresses note 2)

---

## Stage 2: Chain Review - 2026-02-07T13:25:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved (3 warnings, 2 suggestions)

**Issues:**
- [warning] "Base directory" cross-skill Read mechanism labeled as "proven" but is actually unproven — fallback should be treated as likely outcome (at: Step 0b, line 62)
  Suggestion: Treat fallback (copy to own references/) as likely path, not exception
- [warning] Design uses ${CLAUDE_PLUGIN_ROOT} but plan uses Base directory — divergence not listed in Design Divergences table (at: Design Divergences table)
  Suggestion: Add row to divergence table
- [warning] Stage 6 dispatch search target may have leading whitespace in original file (at: Step 4 Change 2)
  Suggestion: Account for leading whitespace when searching
- [suggestion] brainstorm-reviewer already HAS an Input section — Change 1 should REPLACE it, not add after (at: Step 3 Change 1)
- [suggestion] PRD Output Format is inside a fenced code block — edits must be within the fences (at: Step 4 Change 3)

---
