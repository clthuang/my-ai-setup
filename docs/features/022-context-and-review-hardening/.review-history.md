# Review History: 022-context-and-review-hardening

## Stage 1: Spec-Reviewer Review - Iteration 1 - 2026-02-13T13:00:00Z

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Needs Revision

**Issues:**
- [blocker] [specificity] Plan.md extraction rule unspecified — what is "plan item 3.2" structurally? (at: AC-2, Scope)
  Suggestion: Specify the structural format of plan items and extraction rules
- [blocker] [evidence] Feature 020 contradicts Why/Source coverage claim — post-017 but has no traceability fields (at: Feasibility Assessment)
  Suggestion: Acknowledge as counterexample, confirm fallback path is real
- [warning] [testability] AC-9 untestable without live project (at: AC-9)
  Suggestion: Add verification approach that doesn't require live project
- [warning] [completeness] Task ordering in dispatch loop unspecified (at: AC-1, Scope)
  Suggestion: Specify sequential in document order
- [warning] [specificity] Heading matching should be specified, not open question (at: Open Questions 2)
  Suggestion: Promote to specified behavior with substring containment
- [warning] [completeness] Open questions 1-2 on critical path — should be resolved (at: Open Questions)
  Suggestion: Resolve or explicitly defer to design
- [warning] [completeness] Missing SC for spec.md full loading (at: Success Criteria)
  Suggestion: Add SC or fold into SC-2

**Changes Made:**
- Added Heading Extraction Rules to Scope section with substring matching, section boundary rules, and all known plan.md heading variants
- Added task ordering: "sequential in document order (top to bottom in tasks.md)" to Scope and AC-1
- Folded spec.md full loading into SC-2
- Acknowledged feature 020 as counterexample in Feasibility Assessment and Key Assumptions
- Added verification approach to AC-9 (code review of prompt construction, no live project required)
- Promoted Open Questions 1-2 to "Resolved Design Decisions" with concrete rules
- Renumbered remaining Open Questions

---

## Stage 1: Spec-Reviewer Review - Iteration 2 - 2026-02-13T13:15:00Z

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Needs Revision

**Issues:**
- [blocker] [assumptions] Feature 018 uses `Design § Component 2 § scqa-framing.md` format — unhandled by regex, omitted from verified features list (at: Resolved Design Decisions, Heading Extraction Rules)
  Suggestion: Add 018 to known non-matching variants, document as deliberate fallback
- [warning] [assumptions] Plan references at sub-heading granularity (1A.1) fail heading match when sub-items are bold text, not headings — silently degrades to full loading (at: Heading Extraction Rules)
  Suggestion: Add prefix fallback (1A.1 → try 1A) to match parent heading
- [warning] [assumptions] Comma-separated multi-reference values (e.g., `Spec C4.1, Plan 1A.1`) — splitting logic unspecified (at: Resolved Design Decisions, AC-4)
  Suggestion: Add explicit comma-split step before regex matching
- [warning] [testability] AC-9 deferred behavioral testing should be explicit (at: AC-9)
  Suggestion: Add "Full behavioral verification deferred to first project-linked feature"
- [warning] [clarity] SC-7 token budget undefined — "compact" means nothing without numbers (at: SC-7)
  Suggestion: Move ~200-500 token spec from AC-9 into SC-7
- [warning] [traceability] Knowledge bank "retire" action unspecified — what happens when user selects retire? (at: AC-18)
  Suggestion: Specify retire/keep/update outcomes

**Changes Made:**
- Added feature 018 to known non-matching variants in Resolved Design Decisions and Feasibility Assessment
- Added prefix fallback rule (1A.1 → 1A) to Heading Extraction Rules
- Added "Traceability Field Parsing" section with explicit comma-split step before regex matching
- Added deferred testing note to AC-9
- Moved token budget specification into SC-7 with breakdown (~200 base, ~100 per dependency)
- Added retire/keep/update action specifications to AC-18
- Added Implementation-log.md Entry Template to Scope
- Added Primary Modification Targets listing all files to change

---

## Stage 1: Spec-Reviewer Review - Iteration 3 - 2026-02-13T13:30:00Z

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Approved (with 4 warnings, 2 suggestions — no blockers)

**Issues:**
- [warning] [assumptions] Heading extraction feasibility listed as "Likely" without citing concrete heading examples (at: Feasibility Assessment)
  Suggestion: Cite 2-3 actual heading examples from different features
- [warning] [testability] SC-13 knowledge bank validation quality is subjective — LLM judgment (at: SC-13, AC-16/17)
  Suggestion: No change needed, but first retro run should be manually reviewed
- [warning] [clarity] PRD section extraction mechanism unspecified — how to extract Problem Statement + Goals from prd.md (at: In Scope line 35)
  Suggestion: Add exact heading text match clarification
- [warning] [traceability] Missing AC for no-domain-reviewer edge case from PRD edge case table (at: AC-11/12)
  Suggestion: Add to Resolved Design Decisions documenting intent

**Changes Made:**
- Upgraded heading extraction assumption from "Likely" to "Verified across known variants" with concrete examples (017, 019, 020, 021)
- Added manual review calibration note to SC-13
- Added PRD section extraction mechanism (exact heading text match for "Problem Statement" and "Goals")
- Added Resolved Design Decision #3: Domain Reviewer Outcome block presence (only when domain reviewer invoked)
- Added design identifier format examples (C9, Auth-Module, R-1, I-4) to regex description

---

## Stage 1: Spec-Reviewer Review - Iteration 4 - 2026-02-13T13:45:00Z

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Approved (with 3 warnings, 1 suggestion — no blockers)

**Issues:**
- [warning] [testability] AC-9 deferred verification has no mechanism to ensure it happens (at: AC-9)
  Suggestion: Add explicit deferred behavioral verification checkpoint
- [warning] [testability] SC-13 calibration criteria unspecified — what constitutes acceptable match quality (at: SC-13)
  Suggestion: Specify no false positives, no obvious false negatives, challenge text specific and actionable
- [warning] [assumptions] Heading extraction wording conflates "extraction works" with "fallback works" (at: Feasibility Assessment)
  Suggestion: Distinguish extraction accuracy (4/5) from fallback reliability (5/5)

**Changes Made:**
- Added deferred behavioral verification section to AC-9 (first project-linked feature confirms correct content)
- Specified SC-13 calibration criteria (no false positives, no obvious false negatives, challenge text specific and actionable)
- Reworded heading extraction assumption to distinguish extraction accuracy (4/5) from fallback reliability (5/5)

---

## Stage 2: Phase Review - Iteration 1 - 2026-02-13T14:00:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved (with 3 warnings, 2 suggestions — no blockers)

**Issues:**
- [warning] [completeness] Retro-facilitator Step 2 prompt template not mentioned as needing update for implementation-log section (at: Scope)
  Suggestion: Add note about Step 2 prompt template change
- [warning] [clarity] SC-7 project context sizing undefined for large dependency lists (at: SC-7, AC-9)
  Suggestion: Note as design-phase decision whether to cap at ~500 tokens
- [warning] [clarity] SC-7 reads as behavioral criterion but verified via code review only (at: SC-7, AC-9)
  Suggestion: Reword SC-7 to reflect code-review verification

**Changes Made:**
- Added retro-facilitator Step 2 prompt template update note to scope
- Reworded SC-7 to "have code paths to receive" and added design-phase cap decision note

---

## Stage 2: Phase Review - Iteration 2 - 2026-02-13T14:15:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved (zero issues)

**Summary:** Spec is comprehensive and ready for design. All 16 SCs measurable, all 21 ACs use Given/When/Then format, scope boundaries exhaustive, domain reviewer approved at iteration 4/5 with no unresolved issues.

---
