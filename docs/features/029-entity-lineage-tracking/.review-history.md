## Stage 1: Spec-Reviewer Review - Iteration 1 - 2026-02-27T06:05:00Z

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Needs Revision

**Issues:**
- [blocker] [assumptions] Brainstorm type:id format assumes YYYYMMDD-HHMMSS-slug but actual filenames use two historical formats (at: Scope > Phase B, line 35)
  Suggestion: Use full filename stem as brainstorm ID regardless of format
- [blocker] [testability] AC-6 backlog promotion format is ambiguous — 'e.g.' leaves exact modification unspecified (at: AC-6)
  Suggestion: Remove 'e.g.' and specify exact column and string format
- [blocker] [traceability] PRD-required output fields (creation date) missing from AC-1; dependency relationships missing from AC-5 (at: AC-1, AC-5)
  Suggestion: Add creation date to output format; add dependency annotations to project tree
- [warning] [assumptions] create-project.md lacks backlog_source extraction logic — Phase B understates work (at: Feasibility Assessment, Phase B)
  Suggestion: Document that create-project requires porting Handle Backlog Source pattern
- [warning] [assumptions] Brainstorm source pattern assumption overstated as 'Confirmed' — pre-010 brainstorms may lack marker (at: Key Assumptions)
  Suggestion: Downgrade to 'Confirmed for features created after feature 010'
- [warning] [testability] NFR-1 (latency) from PRD not addressed in spec success criteria (at: Success Criteria)
  Suggestion: Add performance characteristic note for Phase B writes
- [warning] [scope] Phase A label 'Read-Only Lineage Derivation' is misleading — includes backlog write-path change (at: Scope > Phase A)
  Suggestion: Rename to 'Lineage Query + Backlog Preservation'
- [warning] [clarity] Phase A downward traversal description conflates Phase B parent-based scanning with Phase A field-based reverse lookup (at: Scope > Phase A)
  Suggestion: Rewrite to specify exact field-specific scan algorithm for Phase A
- [warning] [traceability] PRD edge case 'brainstorm promoted to both project AND feature' not addressed (at: Missing from spec)
  Suggestion: Add resolved question clarifying this does not violate tree constraint
- [warning] [assumptions] Backlog mark-as-promoted assumption 'Needs verification' is on critical path (at: Key Assumptions)
  Suggestion: Audit backlog.md consumers and update status
- [suggestion] [clarity] No command interface specification for /show-lineage (at: Acceptance Criteria)
  Suggestion: Add Command Interface subsection
- [suggestion] [clarity] Phase A-to-B transition gate 'real queries' is ambiguous (at: Resolved Questions)
  Suggestion: Clarify as distinct human invocations and add gap-log.md tracking
- [suggestion] [testability] AC-11 backward compatibility test is underspecified (at: AC-11)
  Suggestion: Specify verifiable criteria (unchanged command files, additive fields only)

**Changes Made:**
- Brainstorm type:id format changed to use full filename stem (both historical formats supported)
- AC-6 backlog promotion format specified exactly: append to Description column, row stays in same table
- AC-1 output format now includes creation date; AC-5 includes dependency annotations from depends_on_features
- Phase A renamed to 'Lineage Query + Backlog Preservation'
- Phase A downward traversal rewritten with explicit field-specific scan algorithm
- Feasibility: added note about create-project requiring backlog_source port
- Feasibility: added NFR-1 latency characteristic for Phase B
- Brainstorm assumption downgraded to 'Confirmed for features created after feature 010'
- Backlog assumption upgraded to 'Confirmed' after audit (only add-to-backlog and create-feature consume backlog.md)
- Added resolved question about dual promotion (brainstorm → project AND feature)
- Added Command Interface section with full argument specification
- Phase transition gate clarified with 'distinct human invocations' and gap-log.md
- AC-11 strengthened with verifiable criteria

---

## Stage 1: Spec-Reviewer Review - Iteration 2 - 2026-02-27T06:15:00Z

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Needs Revision

**Issues:**
- [blocker] [assumptions] Brainstorm type:id resolution assumes .prd.md extension but real data includes .md files — false orphans for pre-.prd.md brainstorms (at: Feasibility line 195, Scope Phase B line 37)
  Suggestion: Try both .prd.md and .md extensions in resolution
- [blocker] [assumptions] Already-deleted backlog items (00019, 00005) make AC-4 untestable — no spec coverage for missing backlog rows (at: AC-4, AC-6, Command Interface)
  Suggestion: Add AC for orphaned backlog root and error case for missing rows
- [blocker] [traceability] PRD circular-reference edge case has no spec coverage — no traversal depth guard (at: PRD Edge Cases, Command Interface, ACs)
  Suggestion: Add max 10-hop traversal depth limit with warning
- [warning] [testability] NFR-1 has no measurable threshold (at: Feasibility line 197)
  Suggestion: Define as 'no additional file reads beyond parent validation read'
- [warning] [testability] NFR-2 not made testable in spec (at: PRD NFR-2)
  Suggestion: Restate as 'single invocation with no background processing'
- [warning] [assumptions] Pre-010 brainstorms without backlog marker create false negatives in descendant queries (at: Phase A line 27, Key Assumptions line 202)
  Suggestion: Add known limitation note to AC-4
- [warning] [traceability] show-status integration left ambiguous — FR-5 partially unresolved (at: Dependencies line 215)
  Suggestion: Explicitly defer to Out of Scope
- [warning] [clarity] AC-6 multi-promotion format undefined — what if same backlog item promoted twice? (at: AC-6, Resolved Questions)
  Suggestion: Specify comma-separated format for multiple promotions
- [warning] [assumptions] No AC for create-project writing parent or backlog_source in Phase B (at: Feasibility line 194, AC-8)
  Suggestion: Add AC-13 for create-project parent field
- [warning] [scope] create-project's backlog behavior not covered by Phase A mark-as-promoted change (at: Phase A line 31)
  Suggestion: Explicitly defer create-project backlog handling to Phase B
- [suggestion] [clarity] --descendants flag description ambiguous 'instead of (or in addition to)' (at: Command Interface line 61)
  Suggestion: Remove parenthetical, standardize to 'instead of'
- [suggestion] [clarity] Phase gate tracking mechanism undefined (at: Resolved Questions line 234)
  Suggestion: Add gap-log.md summary table format

**Changes Made:**
- Brainstorm resolution now tries both .prd.md and .md extensions (type:id format and feasibility updated)
- Added AC-12 for orphaned backlog root (already-deleted items shown as orphaned)
- Added AC-14 for traversal depth guard (max 10 hops)
- Added traversal depth limit to Phase A scope
- Added error cases for depth limit exceeded and missing backlog rows
- Added AC-13 for create-project Phase B parent field and backlog_source port
- AC-6 updated with multi-promotion comma-separated format
- NFR-1 and NFR-2 added to success criteria with testable definitions
- Pre-010 known limitation note added to AC-4
- show-status integration and create-project backlog handling explicitly deferred to Out of Scope
- --descendants flag ambiguity removed
- Phase gate tracking mechanism specified with gap-log.md summary table

---

## Stage 1: Spec-Reviewer Review - Iteration 3 - 2026-02-27T06:25:00Z

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Approved

**Issues (all non-blocking):**
- [warning] [traceability] PRD circular reference edge case divergence not acknowledged — added note to AC-14
- [warning] [traceability] PRD dual promotion edge case reinterpretation not flagged — added parenthetical note
- [warning] [testability] AC-6 pipe character edge case — accepted as non-issue per existing backlog conventions
- [suggestion] [clarity] AC-3 orphaned display inconsistent with AC-12 — aligned to preserve ID from path
- [suggestion] [clarity] show-status in Dependencies misleading — updated description
- [suggestion] [clarity] --feature bare ID matching undefined — accepted as design decision

**Changes Made:**
- AC-14 note added explaining PRD divergence rationale (Phase A vs Phase B mitigation)
- Dual promotion resolved question annotated with PRD correction explanation
- AC-3 orphaned display aligned with AC-12 (ID derived from path, 'unknown' reserved for malformed refs)
- show-status dependency description updated to 'NOT modified by this feature'

---

## Stage 2: Phase Review - Iteration 0 - 2026-02-27T06:30:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved

**Issues (all non-blocking):**
- [warning] Problem statement multi-sentence — accepted (detail aids comprehension)
- [warning] Command Interface prescriptive — accepted (exact CLI syntax helps design, not constraining)
- [warning] SC-11 NFR-1 is Phase B only — annotated with Phase B gating note
- [suggestion] AC-5 depends_on_features scanning not in scope list — added to Phase A scope
- [suggestion] gap-log.md not in dependencies — accepted as implicit Phase A deliverable

**Changes Made:**
- SC-11 annotated with Phase B gating note
- Phase A scope updated with depends_on_features annotation bullet

---

## Design Review - Iteration 1 - 2026-02-27T07:10:00Z

**Reviewer:** design-reviewer (skeptic)
**Decision:** Needs Revision

**Issues:**
- [blocker] [assumptions] Brainstorm-to-backlog upward traversal assumes `*Source: Backlog*` marker always exists in brainstorm files, but real data shows 2 of 3 features with `backlog_source` have brainstorms lacking this marker. Feature 028's brainstorm has no marker; feature 011's uses `**Backlog Item:**` format instead. (at: C3: Upward Traversal Logic)
  Challenge: How does the brainstorm-to-backlog link get discovered when the brainstorm file lacks the marker but the feature's .meta.json has backlog_source?
- [blocker] [completeness] Feature type:id canonical form is ambiguous between `feature:029` and `feature:029-entity-lineage-tracking`. No normalization specified. Phase B parent field matching would fail if one writes bare ID and another writes full ID-slug. (at: C2: Entity Resolution Logic, I3)
  Challenge: Is the canonical form `feature:029` or `feature:029-entity-lineage-tracking`?
- [warning] [consistency] Priority issue when feature has both brainstorm_source AND backlog_source but brainstorm lacks marker — backlog link is lost because brainstorm_source takes priority and brainstorm has no marker. (at: C3, TD-4)
  Challenge: Should the algorithm use the feature's backlog_source to bridge the gap?
- [warning] [completeness] depends_on_features relationship not explicitly clarified as non-parent-child. Users running --descendants on a feature might expect dependent features to appear. (at: C4, C5)
  Challenge: Should features that depend on feature:030 appear as descendants?
- [warning] [feasibility] Path normalization does not specify how project root is determined at runtime. (at: C2: Path normalization)
  Challenge: Is project root from git, from artifacts_root, or hardcoded?
- [warning] [completeness] C6 does not track the output message update in create-feature.md Output section. (at: C6 vs create-feature.md lines 165-166)
  Challenge: Is the output message update tracked as part of C6?
- [warning] [assumptions] Prior art brainstorm_source count is slightly off — 20/28 (~71%) not 21/27 (~78%). (at: Prior Art Research)
  Challenge: Accurate count matters for credibility.
- [warning] [completeness] Orphaned backlog metadata in descendants mode not explicitly specified. (at: C5, I4)
  Challenge: What metadata is shown for an orphaned backlog root in descendants query?

**Changes Made:**
- Added multi-pattern brainstorm backlog marker detection (supports both `*Source: Backlog*` and `**Backlog Item:**` formats)
- Added brainstorm-to-backlog fallback: when brainstorm lacks marker, use calling feature's backlog_source as context
- Documented known limitation: direct brainstorm queries cannot discover backlog link when marker is missing
- Specified canonical feature type:id as ALWAYS `feature:{id}-{slug}` with ID Canonicalization section
- Bare feature IDs normalized to full {id}-{slug} form on resolution
- Reordered Phase A deriveParent for features: project_id first (decomposed features), then brainstorm_source, then backlog_source
- Added explicit note to C4 that depends_on_features is sibling dependency, not parent-child
- Specified project root determination via `git rev-parse --show-toplevel`
- Added output message update requirement to C6
- Added orphaned backlog metadata display specification to I4

---

## Design Review - Iteration 2 - 2026-02-27T07:35:00Z

**Reviewer:** design-reviewer (skeptic)
**Decision:** Needs Revision

**Issues:**
- [blocker] [consistency] Spec line 41 says `feature:028` but design uses `feature:029-entity-lineage-tracking` — inconsistent type:id format (at: C9, spec line 41)
  Challenge: What is the canonical type:id format — bare numeric or full id-slug?
- [blocker] [feasibility] MCP server registration targets non-existent `.mcp.json` file instead of actual `plugins/iflow/.claude-plugin/plugin.json` (at: C8, I1)
  Challenge: Registration in wrong file means entity server won't start
- [blocker] [feasibility] No bootstrap wrapper (`run-entity-server.sh`) for entity server — calling Python directly skips venv resolution (at: C8)
  Challenge: Will fail on first use without existing venv
- [warning] [completeness] Multi-project isolation — global DB shared across all projects with possible entity ID collisions (at: C1, Architecture)
  Challenge: `backlog:00001` could exist in two projects with different meanings
- [warning] [consistency] Phase A/B collapse — design merges both phases but spec still references them separately (at: Architecture)
  Challenge: Design vs spec divergence on phasing
- [warning] [completeness] MCP failure handling — C5/C6/C7 don't specify what happens when entity MCP tools are unavailable (at: C5, C6, C7)
  Challenge: Should entity registration failure block feature creation?
- [warning] [feasibility] Circular reference CTE has self-referencing subquery pattern that may infinite loop (at: C1 circular reference detection)
  Challenge: Subquery `SELECT parent_type_id FROM entities WHERE type_id = c.type_id` is problematic
- [warning] [completeness] Orphaned backlog items (00019, 00005 already deleted) — backfill can't find them in backlog.md (at: C3)
  Challenge: Features with backlog_source pointing to missing rows lose lineage
- [warning] [completeness] Missing `PRAGMA foreign_keys = ON` despite FK constraint on parent_type_id (at: C1 schema, TD-6)
  Challenge: FK constraint is no-op without the pragma
- [suggestion] [consistency] Naming inconsistency between DB class methods (`export_tree`, `find_entities`, `get_children`) and MCP tools (at: C1, C2)
  Challenge: Confusing when methods and tools have different names
- [suggestion] [completeness] Redundant `get_descendants` tool when `get_lineage(direction='down')` does the same thing (at: C2)
  Challenge: Two ways to do the same operation

**Changes Made:**
- Fixed C8 and I1: MCP registration now references `plugins/iflow/.claude-plugin/plugin.json` (the actual manifest)
- Added `run-entity-server.sh` bootstrap wrapper specification following `run-memory-server.sh` pattern
- Added `PRAGMA foreign_keys = ON` to EntityDatabase connection pragmas
- Fixed circular reference CTE: replaced self-referencing subquery with clean upward traversal using parent_type_id joins
- Removed redundant `get_descendants` tool — consolidated into `get_lineage(direction='down')`
- Aligned DB class method names with MCP tool names (removed `find_entities`, `get_children`, renamed `export_tree` to `export_lineage_markdown`)
- Added multi-project isolation rationale: type_ids are inherently unique, cross-project visibility is intentional
- Added Phase A/B merge clarification to architecture (gap-log gate still applies for scope expansion)
- Added MCP failure handling to C5, C6, C7: warn but don't block entity creation
- Added orphaned backlog handling in C3 backfill: synthetic entities with status='orphaned' for deleted items
- Added topological ordering requirement for backfill (backlog → brainstorm → project → feature)
- Added spec alignment note to C9 re: bare numeric IDs normalized during backfill

---

## Design Review - Iteration 3 - 2026-02-27T07:45:00Z

**Reviewer:** design-reviewer (skeptic)
**Decision:** Approved

**Issues (all non-blocking):**
- [warning] [completeness] Backfill scanner uses `{artifacts_root}` but entity server lifespan doesn't specify how to determine this value (at: C2, C3)
  Challenge: How does the entity server know which directory to scan?
- [warning] [completeness] export_lineage_markdown output_path resolution not specified for relative paths (at: C2, I4)
  Challenge: What is output_path relative to?
- [warning] [consistency] Feature count inconsistency: 27 in Prior Art vs 28 actual; 20/28 ratio inconsistent (at: Prior Art, TD-4)
  Challenge: Internal consistency
- [warning] [assumptions] Multi-project backlog ID collisions result in first-writer-wins semantics (at: C1)
  Challenge: Is it acceptable that first project's data wins?
- [warning] [completeness] External brainstorm_source paths (outside project) not handled by backfill scanner (at: C3)
  Challenge: Feature 017 has external brainstorm_source
- [warning] [feasibility] backfill_scan_dirs config field not referenced in entity backfill (at: C3)
  Challenge: Should backfill honor additional scan directories?
- [warning] [completeness] register_entity idempotent behavior unclear when called with different field values (at: C1)
  Challenge: Which values win on duplicate registration?
- [suggestion] [completeness] /show-lineage branch detection fallback when DB is empty (at: C4, I5)
- [suggestion] [complexity] depends_on_features extraction during backfill not listed as explicit step (at: C3, I7)
- [suggestion] [completeness] Non-standard brainstorm filenames may pollute registry (at: C3)

**Changes Made:**
- Added artifacts_root determination to C2 lifespan: read from iflow.local.md via read_config(), same pattern as memory server
- Added output_path resolution note: relative to project root (os.getcwd() at server start)
- Fixed feature count: 27 → 28 throughout Prior Art and TD-4
- Documented backlog ID collision as known limitation with first-writer-wins semantics
- Added external brainstorm_source handling: synthetic entity with status="external"
- Documented backfill_scan_dirs limitation: entity backfill only scans primary artifacts_root
- Specified register_entity as INSERT OR IGNORE semantics (no field modification on duplicate)
- Added depends_on_features extraction step to C3 feature backfill

---

## Stage 4: Handoff Review - Iteration 1 - 2026-02-27T07:50:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision (false positive — reviewer received summary, not full document)

**Issues:**
- [warning] Interface signatures not shown (at: Interfaces I2, I3, I4)
  Suggestion: Add method signatures with parameter types and return types
- [warning] Data flows between components not documented (at: Architecture Overview)
  Suggestion: Add data flow narratives for entity creation and lineage query
- [warning] Risk mitigations not visible (at: Risks R1-R5)
  Suggestion: Confirm each risk has explicit mitigation

**Changes Made:**
No changes needed — all 3 warnings are already addressed in the full design.md:
- Interface signatures: C2 (lines 306-357) has complete Python async def signatures for all 6 tools
- Data flows: Lines 85-100 have 3 explicit data flow narratives (creation, query, export)
- Risk mitigations: R1-R5 (lines 629-657) each have detailed mitigation descriptions
Re-dispatching with full document content.

---

## Stage 4: Handoff Review - Iteration 2 - 2026-02-27T07:55:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision (approved with 4 warnings)

**Issues:**
- [warning] update_entity metadata merge strategy unspecified (at: C1/C2 update_entity)
  Suggestion: State shallow dict merge rule explicitly
- [warning] Bootstrap wrapper deps not listed (at: C8 run-entity-server.sh)
  Suggestion: Confirm dep set required by entity_server.py
- [warning] Branch auto-detection logic not described (at: C4 /show-lineage)
  Suggestion: Describe feature/{id}-{slug} pattern matching
- [warning] Circular reference SQL uses ambiguous ?? placeholder (at: C1 circular reference CTE)
  Suggestion: Use consistent parameter placeholder with label
- [suggestion] export_lineage_markdown output_path resolution note
- [suggestion] gap-log.md file path and format

**Changes Made:**
- Added shallow dict merge semantics to update_entity method doc (C1)
- Listed explicit dep set for entity_server.py in C8 (stdlib + mcp only)
- Added branch detection regex to C4 show-lineage command
- Fixed ?? to ? with bind label in circular reference CTE (C1)

---

## Stage 4: Handoff Review - Iteration 3 - 2026-02-27T08:00:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision (approved with 2 warnings)

**Issues:**
- [warning] TD-1, TD-2, TD-4, TD-5, TD-6 missing alternatives/trade-offs (at: Technical Decisions)
  Suggestion: Add rejected alternative and key trade-off for each
- [warning] export_lineage_markdown output_path resolution ambiguous (at: C2)
  Suggestion: Clarify resolution against artifacts_root vs os.getcwd()
- [suggestion] gap-log.md file path and format (deferred)

**Changes Made:**
- Added "Rejected:" lines with explicit alternative and rejection reasoning for TD-1, TD-2, TD-4, TD-5, TD-6
- Clarified output_path resolution: relative paths resolve against artifacts_root, absolute paths used as-is

---

## Stage 4: Handoff Review - Iteration 4 - 2026-02-27T08:05:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision (approved with 2 warnings)

**Issues:**
- [warning] No test strategy specified (at: Design — missing section)
  Suggestion: Add test strategy section with unit and integration test file paths
- [warning] create-project.md modification under-specified compared to create-feature.md (at: C6)
  Suggestion: Add I6-equivalent interface spec for create-project.md
- [suggestion] gap-log.md file path not explicitly stated (at: I8)

**Changes Made:**
- Added Test Strategy section with unit tests (test_database.py, pytest) and integration tests (test_entity_server.sh)
- Added I6b interface spec for create-project.md with before/after behavior and backlog source parsing
- Added explicit file path for gap-log.md in I8

---

## Stage 4: Handoff Review - Iteration 5 - 2026-02-27T08:10:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision (approved with 2 minor warnings)

**Issues:**
- [warning] Brainstorm glob deduplication not specified (at: C3 step 3)
  Suggestion: Specify .prd.md priority and dedup via idempotency
- [warning] Project entity_id derivation not specified (at: C3 step 2)
  Suggestion: Specify id field from .meta.json

**Changes Made:**
- Specified glob ordering: .prd.md first, then .md for unregistered stems; idempotency as fallback
- Specified project entity_id derivation from .meta.json `id` field

---

## Stage 1: Plan Review - Iteration 1 - 2026-02-27T08:30:00Z

**Reviewer:** plan-reviewer (skeptic)
**Decision:** Needs Revision

**Issues:**
- [blocker] [tdd-order] Step 2 (Entity MCP Server) has no TDD section — jumps straight to implementation with zero tests for tree rendering, metadata parsing, output_path resolution (at: Step 2)
- [blocker] [reasoning] No "Why this item" / "Why this order" rationales on any step (at: All Steps)
- [warning] [dependency] Steps 2 and 3 both depend on Step 1 but are sequenced serially — could be parallel (at: Steps 2-3)
- [warning] [assumption] Phase A/B gate ambiguity — plan implements Phase B writes (Steps 6-8) without acknowledging gap-log gate (at: Steps 6-8)
- [warning] [failure-mode] Dual-write between DB update and backlog.md annotation has no ordering guarantee (at: Step 6)
- [warning] [failure-mode] Partial backfill leaves some entities registered; subsequent startup skips backfill (zero-entity check) (at: Step 3)
- [warning] [assumption] I-prefix identifiers (I1, I5, I6, I6b, I8) undefined in plan (at: Steps 4-9)
- [warning] [feasibility] Backfill tests mixed into test_database.py — different testing concerns (at: Step 3)
- [warning] [dependency] AC-11 output format change from "(removed)" to "(promoted)" needs spec exception citation (at: Step 6)
- [suggestion] [feasibility] Step 1 sub-step 9 ("implement class") could be broken into incremental implementation
- [suggestion] [failure-mode] R3 (pre-010 brainstorm accuracy) missing from risk mitigations table

**Changes Made:**
- Added TDD sub-section to Step 2: tests for tree rendering, metadata parsing, output_path resolution, extracted helper functions (following memory_server.py pattern)
- Added "Why this item" and "Why this order" rationales to all 10 steps
- Added Interface Legend section at top defining I1, I5, I6, I6b, I8
- Updated dependency graph to show Steps 2-3 as parallelizable
- Added Phase Gate Note section explaining gap-log gate scope
- Added write ordering note to Step 6 (DB first, backlog.md second, warn on failure)
- Added AC-11 exception citation to Step 6
- Split backfill tests to separate test_backfill.py
- Added backfill_complete marker to Step 3 for partial-backfill recovery
- Updated Step 1 to clarify incremental test-then-implement per sub-step
- Added R3 to risk mitigations table
- Updated bootstrap wrapper (Step 4) to use `uv` for venv/deps (per user requirement), with pip fallback
- Updated design.md C8 bootstrap script to use `uv` with pip fallback

---

## Stage 1: Plan Review - Iteration 2 - 2026-02-27T08:45:00Z

**Reviewer:** plan-reviewer (skeptic)
**Decision:** Approved with 5 warnings

**Issues:**
- [warning] [assumption] mcp version constraint safe now but both servers need coordinated upgrades if mcp 2.x releases (at: Step 4)
- [warning] [dependency] semantic_memory.config import — potential numpy transitive dependency via __init__.py (at: Step 2)
- [warning] [failure-mode] Shared venv: entity server bootstraps first → memory server missing numpy/dotenv (at: Step 4)
- [warning] [feasibility] Step 3 TDD order reads as "all tests then implement" vs Step 1's incremental pattern (at: Step 3)
- [warning] [dependency] Step 2 sub-step 6 lifespan imports backfill.py — cannot finalize before Step 3 completes (at: Step 2/3 parallelism)

**Changes Made:**
- Added I2, I3, I4, I7 to Interface Legend for completeness
- Verified semantic_memory.__init__.py has no numpy imports — added safety note to Step 2 sub-step 6
- Added shared venv note to Step 4 documenting the bootstrap ordering edge case
- Restructured Step 3 TDD order to incremental test-then-implement pattern matching Step 1
- Added parallelism note to Step 2: sub-steps 1-5 parallel with Step 3, sub-step 6 waits for Step 3
- Added version constraint synchronization comment to Step 4

---

## Stage 1: Plan Review - Iteration 3 - 2026-02-27T09:00:00Z

**Reviewer:** plan-reviewer (skeptic)
**Decision:** Approved with 3 warnings

**Issues:**
- [warning] [assumption] plugin.json path in Step 4 Files list should be .claude-plugin/plugin.json (at: Step 4)
- [warning] [assumption] INSERT OR IGNORE rationale not explicit — could be confused with upsert pattern (at: Step 3 sub-step 6)
- [warning] [dependency] depends_on-to-lineage mapping unclear in Step 7 (at: Step 7)

**Changes Made:**
- Fixed plugin.json path reference to .claude-plugin/plugin.json
- Added explicit rationale for INSERT OR IGNORE vs upsert in Step 3 sub-step 6
- Added depends_on mapping clarification to Step 7: sibling dependencies stored in metadata, not parent-child lineage

---

## Stage 1: Plan Review - Iteration 4 - 2026-02-27T09:15:00Z

**Reviewer:** plan-reviewer (skeptic)
**Decision:** Approved with 2 observational warnings

**Issues:**
- [warning] [assumption] uv-created venv compatibility with pip — uv venvs are standard PEP 405 virtualenvs, fully compatible with pip. No change needed. (at: Step 4)
- [warning] [failure-mode] Partial backfill entities already registered — INSERT OR IGNORE handles re-runs safely, no data corruption. No change strictly needed. (at: Step 3)
- [suggestion] [assumption] entity_registry modules should stay stdlib-only (no numpy) — already the case per plan

**Changes Made:**
- Added explicit uv venv PEP 405 compatibility note to Step 4
- Added partial re-run safety explanation to Step 3 sub-step 8

---

## Stage 1: Plan Review - Iteration 5 - 2026-02-27T09:30:00Z

**Reviewer:** plan-reviewer (skeptic)
**Decision:** Approved with 3 informational warnings (iteration cap reached)

**Issues:**
- [warning] [assumption] Spec/design divergence on create-project backlog handling — spec defers to Phase B, design I6b includes it in merged-phase approach. Intentional. (at: Step 7)
- [warning] [failure-mode] Multi-promotion annotation format not specified — AC-6 requires comma-separated format inside existing parenthetical. (at: Step 6)
- [warning] [dependency] Parallel development import concern — entity_server.py backfill import only added in sub-step 6, not during sub-steps 1-5. (at: Step 2)
- [suggestion] [feasibility] Verify which brainstorm backlog marker formats actually exist in codebase
- [suggestion] [tdd-order] Clarify boundary between export_lineage_markdown (C1) and render_tree (C2)
- [suggestion] [assumption] Note multi-project backlog ID collision limitation in Step 3

**Changes Made:**
- Added spec divergence note to Step 7
- Added multi-promotion format detail to Step 6
- Added parallel development import clarification to Step 2

---

## Stage 2: Chain Review - Iteration 0 - 2026-02-27T09:45:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved with 2 warnings

**Issues:**
- [warning] Step 2 parallelism note says "Steps 1-5" which could be misread as Steps (not Sub-steps) — clarify prefix (at: Step 2)
- [warning] TDD sub-steps missing refactor phase — task engineers may omit refactor tasks (at: Steps 1, 2, 3)
- [suggestion] Step 9 sequencing inconsistency (depends on Nothing but listed in Steps 5-9 batch)
- [suggestion] Interfaces I2, I3, I4, I7 not referenced in step body text

**Changes Made:**
- Clarified Step 2 parallelism note to say "Step 2's sub-steps 1-5"
- Added explicit refactor pass sub-step to Steps 1, 2, and 3

---

## Stage 2: Chain Review - Iteration 1 - 2026-02-27T09:55:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision

**Issues:**
- [blocker] C9 (ID Canonicalization) not explicitly assigned to a step — already in Step 1 Component field but description not clear enough (at: Steps 1-10)
- [blocker] C10 (Tree Rendering) not explicitly assigned to a step — already in Step 2 Component field but description not clear enough (at: Steps 1-10)
- [warning] No rollback points identified in sequencing (at: Sequencing Summary)

**Changes Made:**
- Reinforced C9 assignment in Step 1 description with explicit bold callout and TDD sub-step cross-reference
- Reinforced C10 assignment in Step 2 description with explicit bold callout and TDD sub-step cross-reference
- Added Rollback gates section to Sequencing Summary

---

## Stage 2: Chain Review - Iteration 2 - 2026-02-27T10:05:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision

**Issues:**
- [blocker] Interfaces I2 (register_entity), I3 (get_lineage), I4 (export_lineage_markdown), and I7 (depends_on_features) not explicitly assigned to plan steps (at: Steps 2, 7)
- [warning] Sub-step contents unnamed in Sequencing Summary — only counts given (at: Sequencing Summary)
- [warning] Critical path not explicitly labeled (at: Sequencing Summary)

**Changes Made:**
- Added "Implements interfaces:" line to Step 2 listing I2, I3, I4
- Added "Implements interfaces:" line to Step 7 listing I7 with cross-reference to depends_on mapping
- Added I7 label to depends_on mapping in Step 7 implementation details
- Added critical path statement to Sequencing Summary
- Added step names to all Sequencing Summary text lines

---

## Stage 2: Chain Review - Iteration 3 - 2026-02-27T10:15:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved with 1 warning

**Issues:**
- [warning] Step 2's intra-step parallelism boundary (sub-steps 1-5 parallel with Step 3, sub-step 6 requires Step 3 complete) could be missed by task authors (at: Step 2 Parallelism note)

**Changes Made:**
- Added "Task creation guidance" note to Step 2 explicitly instructing task authors to split sub-steps 1-5 from sub-step 6 and mark sub-step 6 as blocked on Step 3

---

## Stage 2: Chain Review - Iteration 4 - 2026-02-27T10:25:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved with 2 warnings

**Issues:**
- [warning] Step 2 parallelism wording ambiguous — "Sub-step 6 waits for Step 3" could be misread as waiting for part of Step 3 (at: Step 2 Parallelism note)
- [warning] Step 9 (Gap Log Template) has no done-when criteria — task author can't verify completion (at: Step 9)
- [suggestion] Step 10 documentation files enumeration
- [suggestion] Risk Mitigations section references opaque

**Changes Made:**
- Restated Step 2 parallelism note: "Sub-step 6 must be sequenced after Step 3 is fully complete" with explicit import reasoning
- Updated task creation guidance to reference "Step 3's final task (not just any sub-step)"
- Added "Done when" marker to Step 9 with specific file path, table requirements, and design I8 reference

---

## Stage 2: Chain Review - Iteration 5 - 2026-02-27T10:35:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved (0 blockers, 0 warnings, 2 suggestions only)

**Issues (non-blocking):**
- [suggestion] Step 9 could reinforce "anytime" parallelism in step body
- [suggestion] Step 2 sub-step 6 dependency on Step 3 could name "sub-step 9" explicitly

**Changes Made:**
None needed — suggestions are informational and do not affect task creation readiness.

---

## Task Review Iteration 1 - 2026-02-27T10:45:00Z (Stage 1)

**Decision:** Needs Revision

**Issues:**
- [warning] Task 1.2: Trigger assertion not explicit — add all 5 trigger names for binary verification
- [warning] Task 1.4: Bare ID normalization test lacks concrete example — add known name→slug mapping
- [warning] Task 1.18: Refactor Done-when subjective — add executable test command and helper extraction check
- [warning] Task 4.1: Done-when not binary — add import verification command
- [warning] Task 4.2: Done-when subjective code review — add test pass gate and delegation check
- [warning] Task 4.3: Done-when not binary — add syntax check and 3-path verification
- [warning] Task 5.1: Done-when vague — add 7-section checklist
- [warning] Task 10.2: False dependency on Task 10.1 — change to parallel with same P4 dependencies

**Changes Made:**
All 8 warnings addressed:
- Task 1.2: Added explicit assertion of all 5 trigger names in sqlite_master
- Task 1.4: Added concrete test example with register_entity call and expected type_id
- Task 1.18: Added pytest -v command and shared helper extraction check
- Task 4.1: Added python import verification command with PYTHONPATH
- Task 4.2: Added pytest pass gate and delegation pattern check
- Task 4.3: Added bash -n syntax check, chmod +x, and 3-path description
- Task 5.1: Added 7-section checklist in Action field
- Task 10.2: Changed dependency to Tasks 5.1, 6.2, 7.2, 8.1 (parallel with 10.1, 10.3)

---

## Task Review Iteration 2 - 2026-02-27T10:55:00Z (Stage 1)

**Decision:** Needs Revision

**Issues (real issues from full review — 9 false-positive blockers from truncated prompt excluded):**
- [blocker] Task 1.4: Slug derivation example contradictory — `entity_id="029"` cannot produce `type_id="feature:029-entity-lineage-tracking"` without deriving slug from name
- [warning] Task 1.4: Method signature not specified — engineer unclear on parameter list
- [warning] Task 1.4: Fixture pattern unspecified — no reference to existing test patterns
- [warning] Task 1.9: Circular detection boundary behavior ambiguous — unclear what happens at depth 10 without finding child
- [warning] Task 1.18: Refactor helper specificity weak — "at least one shared helper" too vague

**Changes Made:**
- Task 1.4: Fixed contradictory slug example — clarified entity_id is always caller-supplied as the full ID string (e.g., "029-entity-lineage-tracking"), no slug derivation needed. Added full method signature: `register_entity(self, type_id: str, entity_type: str, entity_id: str, name: str, ...)`. Added pytest fixture pattern reference to semantic_memory/test_database.py.
- Task 1.9: Added explicit circular detection behavior: if child found in ancestor chain at any depth 1-10, raise error; if depth 10 reached without finding child, allow assignment.
- Task 1.18: Specified exact helper names: `_now_iso()` and `_validate_entity_type()`.

---

## Task Review Iteration 3 - 2026-02-27T11:10:00Z (Stage 1)

**Decision:** Needs Revision

**Issues:**
- [blocker] Task 1.2: Missing entities table column list inline — engineer can't verify test completeness without reading design
- [blocker] Task 1.3: Missing full CREATE TABLE DDL — engineer can't implement schema without reading design
- [blocker] Task 1.4: type_id as both parameter AND constructed internally — contradictory interface
- [blocker] Task 1.9: Depth limit behavior ambiguous for chains >10 hops
- [blocker] Task 2.7: Missing function signatures for _process helpers
- [blocker] Task 2.1: Missing entity dict schema for render_tree input
- [blocker] Task 4.1: Missing directory creation and import path details
- [blocker] Task 4.3: uv resolution order needs concrete flow description
- [warning] Task 5.1: Missing type_id construction table for each flag
- [warning] Task 6.2: Missing exact text transformation for backlog.md annotation
- [warning] Task 1.18: "verify naming consistency" too vague — needs concrete verification step
- [warning] Task 3.4: Missing explicit regex patterns for both brainstorm-to-backlog marker formats
- [warning] Task 3.1: Missing minimal fixture content for mock files
- [warning] Task 4.2: Missing verification step with interface reference
- [warning] Task 4.5: Missing test mechanism clarification (wrapper vs MCP round-trip)
- [warning] Task 10.3: Should depend on both 10.1 and 10.2

**Changes Made:**
- Task 1.2: Added full 10-column schema inline with types and constraints
- Task 1.3: Added full CREATE TABLE DDL with all columns, 5 triggers, 3 indexes
- Task 1.4: Removed type_id from parameter list — constructed internally as `f"{entity_type}:{entity_id}"`, returned as string
- Task 1.5: Updated signature to match new register_entity (without type_id param)
- Task 1.9: Added explicit CTE SQL and clarified depth limit is for query safety, not cycle detection
- Task 2.1: Added entity dict key schema and example fixture
- Task 2.7: Added explicit function signatures with parameter types and return types
- Task 4.1: Added `os.makedirs` call, import path (`from entity_registry.backfill import run_backfill`), db_path construction
- Task 4.3: Replaced vague "3 paths" with explicit 4-step resolution flow with commands for each step
- Task 5.1: Added type_id construction table mapping each flag to its type_id format
- Task 6.2: Added exact before/after backlog.md row transformation and multi-promotion format
- Task 1.18: Replaced "verify naming consistency" with concrete `grep -n 'def '` verification step
- Task 3.4: Added explicit regex patterns for both marker formats
- Task 3.1: Added minimal fixture content for `.meta.json`, `.prd.md`, and `backlog.md`
- Task 4.2: Added verification step referencing design interfaces I2/I3/I4
- Task 4.5: Clarified test mechanism as background process with JSON-RPC stdin pipe
- Task 10.3: Added Task 10.2 to dependency list

---

## Task Review Iteration 4 - 2026-02-27T11:30:00Z

**Decision:** Needs Revision

**Issues:**
- [blocker] Task 1.2: CHECK pseudo-SQL `CHECK(IN backlog/...)` not valid SQL syntax
- [blocker] Task 1.9: CTE uses `?` bind parameters without clear mapping — ambiguous
- [blocker] Task 4.3: System python3 path (step 2) missing fast path for mcp already importable
- [blocker] Task 4.5: JSON-RPC payload testing scope too broad for wrapper integration test
- [blocker] Task 5.1: Bare ID resolution mechanism unspecified
- [blocker] Task 2.1: Missing concrete expected output format example
- [blocker] Task 4.1: Dual-responsibility backfill check in both server and backfill module
- [warning] Task 1.13: Missing downward CTE skeleton for descendant traversal
- [warning] Task 2.7: get_lineage return type not specified
- [warning] Task 4.4: Missing exact JSON fragment for plugin.json entry
- [warning] Task 6.1: Missing insertion point in create-feature.md
- [warning] Task 7.2: depends_on_features list element format unspecified
- [warning] Task 10.3: Dependency on 10.1/10.2 unnecessary — files are independent, should be parallel
- [warning] Task 3.1: Missing smoke test assertion details

**Changes Made:**
- Task 1.2: Fixed CHECK pseudo-SQL to exact SQL `CHECK(entity_type IN ('backlog','brainstorm','project','feature'))`
- Task 1.9: Replaced `?` placeholders with named bind parameters `:proposed_parent` and `:child` with explicit descriptions
- Task 1.13: Added full upward AND downward CTE skeletons with ORDER BY clauses and return type `list[dict]`
- Task 2.1: Added concrete expected output format with 3-node linear chain example rendering
- Task 2.7: Added explicit `list[dict]` return type for get_lineage in _process_get_lineage description
- Task 3.1: Added smoke test `test_fixtures_smoke` with specific assertions (file exists, JSON parseable, key present)
- Task 4.1: Removed dual-responsibility — server calls `run_backfill(db, artifacts_root)` unconditionally; idempotency guard is inside run_backfill
- Task 4.3: Added system python3 fast path `python3 -c "import mcp.server.fastmcp" 2>/dev/null`, added stderr redirection for all diagnostics
- Task 4.4: Added exact JSON fragment for plugin.json `entity-registry` entry with `${CLAUDE_PLUGIN_ROOT}` path
- Task 4.5: Scoped down to wrapper bootstrap mechanics only (syntax check, executable, PYTHONPATH, startup), not JSON-RPC protocol testing
- Task 5.1: Specified bare ID resolution: call `get_entity` MCP tool first, then glob features dir for `{id}-*` pattern as fallback
- Task 6.1: Specified insertion point: after "Create `.meta.json`" step and before "Handle PRD Source"
- Task 7.2: Specified depends_on_features element format as `"feature:{id}-{slug}"` type_id strings
- Task 10.3: Changed dependencies from 10.1+10.2 to same as 10.1/10.2 (Tasks 5.1, 6.2, 7.2, 8.1) — all three P5 tasks run in parallel

---

## Task Review Iteration 5 - 2026-02-27T12:20:00Z

**Decision:** Needs Revision (iteration cap reached — 5/5)

**Issues:**
- [blocker] Tasks 3.3, 3.5, 3.7, 3.9, 3.11: Phase 2B implementation tasks lack function signatures and file parsing logic details compared to Phase 1 TDD tasks
- [blocker] Task 4.5: Server startup test has no DB isolation mechanism for cleanup
- [blocker] Task 6.1: Done-when mentions set_parent but Action section does not include set_parent call
- [warning] Task 1.7: Triggers created in Task 1.3 but test written in 1.6 — breaks strict RED-GREEN TDD pattern
- [warning] Task 1.18: Non-binary done-when (grep output "reviewed" is subjective)
- [warning] Task 3.12: Missing explicit test command in done-when
- [warning] Task 4.3: Missing PYTHONUNBUFFERED=1 export for MCP stdio protocol
- [warning] Task 4.2: References design I2/I3/I4 but doesn't specify what to verify against them
- [warning] Task 5.1: Non-binary done-when ("manually verify" is subjective)
- [suggestion] Tasks 3.4/3.5: Constant definition timing — should define regex patterns before tests use them
- [suggestion] Task 9.1: Could run in parallel group P1 since it has no dependencies
- [suggestion] Tasks 10.x: Missing traceability back to spec ACs

**Changes Made:**
None — iteration cap reached. Concerns noted in .meta.json taskReview.concerns. Proceeding to Stage 2 (phase-reviewer).

---

## Stage 2: Chain Review - Iteration 0 - 2026-02-27T12:30:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision

**Issues:**
- [blocker] Task 6.1: Done-when mentions set_parent but Action doesn't include it — contradicts register_entity with parent_type_id parameter
- [blocker] Tasks 3.3, 3.5, 3.7, 3.9, 3.11: Phase 2B implementation tasks lack function signatures
- [warning] Task 1.7: TDD RED-GREEN pattern break (triggers created in 1.3 but tested in 1.6)
- [warning] Task 1.18: Non-binary done-when (grep output "reviewed")
- [warning] Task 3.12: Missing explicit test command in done-when
- [warning] Task 4.3: Missing PYTHONUNBUFFERED=1 export
- [warning] Task 4.2: References design I2/I3/I4 without specifying verification steps
- [warning] Task 4.5: No DB isolation mechanism for test cleanup
- [warning] Task 5.1: Non-binary done-when ("manually verify")

**Changes Made:**
- Task 6.1: Removed set_parent from Done-when; register_entity already uses parent_type_id parameter
- Task 3.3: Added full function signature `run_backfill(db: EntityDatabase, artifacts_root: str) -> None` with ENTITY_SCAN_ORDER and stub scanner functions
- Task 3.5: Added `_derive_parent(entity_type, meta, brainstorm_content) -> str | None` with full lookup priority table and regex patterns
- Task 3.7: Added `_register_synthetic(db, entity_type, entity_id, name, status) -> str` with both use cases described
- Task 3.9: Specified glob ordering logic (`.prd.md` first, collect stems in set, filter `.md`)
- Task 3.11: Added guard pattern `if db.get_metadata("backfill_complete") == "1": return` and `set_metadata` call
- Task 1.6: Changed Done-when from FAIL(RED) to PASS(GREEN) — acknowledges triggers from Task 1.3
- Task 1.7: Rewritten to clarify verification role with explicit pytest command
- Task 1.18: Replaced "output reviewed" with binary grep checks for _now_iso and _validate_entity_type
- Task 3.12: Added explicit `python -m pytest` command and `grep -c` check for module-level patterns
- Task 4.3: Added `export PYTHONUNBUFFERED=1` to Action and grep check to Done-when
- Task 4.2: Added concrete parameter name checks (I2: register_entity params, I3: get_lineage params)
- Task 4.5: Added DB isolation via ENTITY_DB_PATH env var with mktemp and cleanup in trap
- Task 5.1: Replaced "manually verify" with grep-based binary checks (section count, get_lineage, frontmatter)

---

## Stage 2: Chain Review Iteration 1 - 2026-02-27T11:00:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision (approved: true but 3 warnings remain)

**Issues:**
- [warning] Task 4.3 "follow run-memory-server.sh pattern" conflicts with 4-path resolution spec (uv step is new) → Clarify that run-entity-server.sh extends the 3-path pattern with uv as step 3
- [warning] Task 4.5 server-start test lacks concrete timeout/mechanism pattern → Add specific timeout pattern with kill -0 check
- [warning] Task 3.11 conditional get_metadata/set_metadata placement unclear — should be part of Task 1.3 → Move get_metadata/set_metadata to Task 1.3 implementation spec
- [suggestion] Task 6.2 multi-promotion format undefined in Done-when
- [suggestion] Tasks 10.1-10.3 missing specific component count deltas

**Changes Made:**
- Task 1.3: Added get_metadata/set_metadata methods to __init__ implementation spec (matching MemoryDatabase pattern)
- Task 4.3: Clarified that run-entity-server.sh extends run-memory-server.sh's 3-path pattern with uv as step 3
- Task 4.5: Added concrete server-start test pattern with timeout 3, kill -0, and exit code checks
- Task 3.11: Removed conditional clause about adding get_metadata/set_metadata — now references Task 1.3

---

## Stage 2: Chain Review Iteration 2 - 2026-02-27T11:15:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision (approved: true but 2 warnings remain)

**Issues:**
- [warning] _scan_projects and _scan_features full-body implementations never explicitly tasked — scanner stubs from Task 3.3 not visibly filled in → Added note to Task 3.12 and grep check for register_entity calls in each scanner
- [warning] Task 7.1 done-when ambiguous: set_parent used for brainstorm→backlog link vs parent_type_id for project→brainstorm → Clarified which entity uses which parent-assignment mechanism

**Changes Made:**
- Task 3.12: Added note that all four scanner functions must have non-stub bodies; added `grep -c 'register_entity' backfill.py` returning 4+ to Done-when
- Task 7.1: Clarified Action to distinguish set_parent (brainstorm→backlog) from parent_type_id (project→brainstorm); updated Done-when accordingly

---

## Stage 2: Chain Review - Iteration 3 - 2026-02-27T11:30:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision

**Issues:**
- [warning] Tasks 2.7/2.8 only define _process_register_entity and _process_get_lineage helpers, but Task 4.1 states all 6 MCP tools wrap "corresponding extracted helper functions from server_helpers.py". No P2A tasks cover _process_set_parent, _process_get_entity, _process_update_entity, or _process_export_lineage_markdown. (at: Task 4.1 Action vs Tasks 2.7/2.8)
- [suggestion] Tasks 10.1-10.3 missing component count deltas (at: Phase 5)

**Changes Made:**
- Task 4.1: Clarified that only register_entity and get_lineage use extracted _process_* helpers; remaining 4 tools delegate directly to db.* methods (≤5 lines each, per Task 4.2 verification)

---

## Stage 2: Chain Review - Iteration 4 - 2026-02-27T12:00:00Z

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision (approved: true but 3 warnings — iteration cap reached at 5/5)

**Issues:**
- [warning] Task 3.12 done-when uses `grep -c '^BACKLOG_MARKER_PATTERN'` which constrains constant names too tightly — implementer may name patterns differently (at: Phase 2B, Task 3.12)
- [warning] Task 1.7 mixes verify and fix concerns but acceptable as-is for implementation (at: Phase 1, Task 1.7)
- [warning] Task 4.5 `timeout 3` with `sleep 1` may cause flaky test failures on slow machines (at: Phase 3, Task 4.5)
- [suggestion] Task 4.3 should note no numpy/dotenv dependencies needed for entity_registry
- [suggestion] Task 4.1 "unconditionally" wording may confuse re: Task 3.11 idempotency guard

**Changes Made:**
- Task 3.12: Changed grep pattern from `'^BACKLOG_MARKER_PATTERN'` to `'^[A-Z_]+PATTERN\s*='` — matches any module-level regex constant without constraining names
- Task 4.5: Increased timeout from 3 to 5 seconds and sleep from 1 to 2 seconds to reduce flaky failures on slow machines
- Task 1.7: No change needed — reviewer confirmed acceptable as-is

---
