# Review History — 033-comprehensive-prompt-refactor (specify)

## Stage 1: Spec-Reviewer Review - Iteration 1 - 2026-02-28T20:20:00+08:00

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Needs Revision

**Issues:**
- [blocker] [testability] SC-2/AC-8 claim ~28 subjective adjective instances; actual grep returns 73 raw matches (44 agents, 12 commands, 17 SKILL.md files). Work estimate materially wrong. (at: SC-2, AC-8, FR-9)
  Suggestion: Run actual grep and update count
- [blocker] [testability] AC-7 "orthogonal task" undefined — <=3 constraint untestable without definition and enumerated splits (at: AC-7, SC-6)
  Suggestion: Define orthogonal task and enumerate specific splits per command
- [blocker] [assumptions] AC-4/AC-13 behavioral equivalence undefined — "functionally identical" and "equivalent quality" have no verification procedure, despite PRD noting content ordering affects model attention (at: AC-4, AC-13)
  Suggestion: Define concrete comparison procedure
- [warning] [testability] SC-1/AC-1 cache-friendliness behavioral anchors not specified (at: SC-1, AC-1)
  Suggestion: Add Pass/Partial/Fail anchors
- [warning] [assumptions] AC-6/SC-5 contradiction: "zero math" vs secretary "keep if simple enough" (at: AC-6, SC-5)
  Suggestion: Make decision and define trivial-math boundary
- [warning] [scope] AC-5 JSON schema location unclear (command dispatch vs agent file) (at: AC-5, FR-6)
  Suggestion: Clarify coordination between command and agent schemas
- [warning] [testability] AC-3 60-minute time constraint not meaningfully testable (at: AC-3, NFR-1)
  Suggestion: Soften to soft target
- [warning] [clarity] AC-9 terminology convention doesn't cover commands (at: AC-9)
  Suggestion: Extend convention to all component types
- [warning] [traceability] PRD SC about agent caching preservation missing from spec (at: Success Criteria)
  Suggestion: Add SC-10
- [warning] [assumptions] AC-11 hookify mechanism undefined (at: AC-11, SC-8)
  Suggestion: Reference existing hookify plugin

**Changes Made:**
- Updated subjective adjective count from ~28 to ~73 raw matches across 38 files — Reason: blocker 1
- Defined "orthogonal task" and enumerated specific chain splits for both commands — Reason: blocker 2
- Added concrete behavioral equivalence verification procedure to AC-13 with 5-step comparison — Reason: blocker 3
- Added cache-friendliness Pass/Partial/Fail behavioral anchors to AC-1 — Reason: warning 1
- Resolved math contradiction: defined trivial-math exception in SC-5, applied to secretary scoring in AC-6 — Reason: warning 2
- Clarified AC-5 schema goes in command dispatch, must be consistent with agent file — Reason: warning 3
- Softened AC-3 time constraint to soft target with API variance note — Reason: warning 4
- Extended terminology convention in AC-9 to cover commands — Reason: warning 5
- Added SC-10 for agent caching preservation — Reason: warning 6
- Referenced existing hookify plugin in AC-11 — Reason: warning 7
- Scoped AC-10 passive voice verification to promptimize as verifier — Reason: suggestion 1
- Resolved all Open Questions and promoted to Resolved Decisions — Reason: suggestion 3

---

## Stage 1: Spec-Reviewer Review - Iteration 2 - 2026-02-28T20:30:00+08:00

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Approved with warnings

**Issues:**
- [warning] [traceability] SC-5 refines PRD's blanket "zero math" without noting the divergence (at: SC-5, AC-6)
  Suggestion: Add explicit refinement note with rationale
- [warning] [testability] SC-10 "spot check" is not reproducible verification (at: SC-10)
  Suggestion: Define concrete verification method
- [warning] [testability] AC-3 soft target in acceptance criteria is not acceptance-gating (at: AC-3)
  Suggestion: Move runtime to non-functional note
- [warning] [assumptions] AC-7 unclear whether agent files are split or same agent called multiple times (at: AC-7)
  Suggestion: Clarify agent invocation approach
- [warning] [scope] AC-8 adjective removal and SC-10 ordering preservation have no conflict procedure (at: SC-10, AC-8)
  Suggestion: Add preservation note to AC-8
- [warning] [testability] AC-13 behavioral equivalence allows severity distribution shifts (at: AC-13 step 4)
  Suggestion: Add severity shift check
- [warning] [assumptions] AC-1 covers skill but promptimize command Step 5 also needs denominator update (at: AC-1, SC-1)
  Suggestion: Mention both skill and command explicitly

**Changes Made:**
- Added refinement note to SC-5 explaining divergence from PRD with rationale — Reason: warning 1
- Replaced "spot check" with concrete diff-based verification of all 28 agent files — Reason: warning 2
- Separated AC-3 runtime into non-functional note (not acceptance-gating) — Reason: warning 3
- Clarified AC-7: same agent called with narrower scope per chain, no new agent files — Reason: warning 4
- Added SC-10 preservation note to AC-8 for adjective replacements in agent files — Reason: warning 5
- Added severity distribution shift check to AC-13 step 4 — Reason: warning 6
- Updated AC-1 to cover both promptimize skill and command file updates — Reason: warning 7
- Fixed AC-10 to reference technique_currency dimension by name — Reason: suggestion
- Clarified AC-4 behavioral equivalence scope: full procedure for pilot files, diff review for rest — Reason: suggestion

---

## Stage 1: Spec-Reviewer Review - Iteration 3 - 2026-02-28T20:45:00+08:00

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Approved with warnings

**Issues:**
- [warning] [traceability] SC-5 PRD divergence: PRD is not updated retroactively, should clarify relationship (at: SC-5)
  Suggestion: Add note that PRD is input document, spec refinements expected
- [warning] [testability] AC-8 domain-specific adjective exclusion boundary not clearly defined for data science review checklists (at: AC-8, SC-2)
  Suggestion: Add explicit definition of domain-specific term exclusion
- [warning] [testability] AC-4 non-pilot verification "manual review of diff" is not measurable (at: AC-4)
  Suggestion: Add automated diff check criteria (no lines deleted/added, only moved)
- [warning] [assumptions] AC-7 agent system prompt may cause evaluation of out-of-scope axes when dispatched with subset (at: AC-7)
  Suggestion: Add explicit subset scope override instruction requirement
- [warning] [scope] AC-4/FR-4/FR-5 no selection rationale for the 9 files chosen for restructuring (at: AC-4, In Scope)
  Suggestion: Add one-liner explaining selection criteria

**Changes Made:**
- Added note to SC-5 that PRD is input document, not retroactively updated — Reason: warning 1
- Added domain-specific term exclusion definition to AC-8 for statistical terminology — Reason: warning 2
- Replaced manual diff review with automated diff criteria for non-pilot files in AC-4 — Reason: warning 3
- Added subset scope override requirement to AC-7 for agent dispatch — Reason: warning 4
- Added selection rationale for 9 files in scope section — Reason: warning 5

---

## Stage 1: Spec-Reviewer Review - Iteration 4 - 2026-02-28T20:55:00+08:00

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Approved

**Issues:**
- [suggestion] [assumptions] AC-4 automated diff "no lines added" may conflict with boundary marker comments (at: AC-4)
  Suggestion: Amend to permit structural markers
- [suggestion] [clarity] AC-7 synthesis chain input contract not explicit (at: AC-7)
  Suggestion: Specify Chain 3 receives JSON outputs of Chain 1 and 2

**Changes Made:**
None required — zero blockers and zero warnings. Suggestions noted for design phase.

---

## Stage 2: Phase Review - Iteration 1 - 2026-02-28T21:00:00+08:00

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved with warnings

**Issues:**
- [warning] [testability] AC-4 non-pilot automated diff lacks semantic ordering check (at: AC-4)
  Suggestion: Add condition that named static sections are fully before first dynamic marker
- [warning] [clarity] AC-7 synthesis chain (Chain 3) input contract not specified (at: AC-7)
  Suggestion: Specify Chain 3 receives JSON outputs from Chains 1 and 2
- [warning] [assumptions] AC-11 hookify rule `.local.md` naming ambiguous — local-only vs committed (at: AC-11)
  Suggestion: Clarify that `.local.md` is intentional local-only convention

**Changes Made:**
- Added semantic ordering condition (c) to AC-4 non-pilot verification — Reason: warning 1
- Added synthesis chain input contract to AC-7 (Chain 3 receives JSON from Chains 1+2, no re-read) — Reason: warning 2
- Clarified AC-11 `.local.md` naming as intentional local-only per project convention — Reason: warning 3

---

## Stage 2: Phase Review - Iteration 2 - 2026-02-28T21:10:00+08:00

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved

**Issues:**
- [suggestion] [testability] AC-9 hook script verification method unspecified (at: AC-9)
  Suggestion: Add grep-based verification method
- [suggestion] [traceability] SC-5 PRD divergence note could explicitly reference PRD SC-5 (at: SC-5)
  Suggestion: Add cross-reference to PRD Success Criteria SC-5

**Changes Made:**
None required — zero blockers and zero warnings. Suggestions noted for design phase.

---
