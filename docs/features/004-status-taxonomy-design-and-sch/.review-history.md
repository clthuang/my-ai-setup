# Review History: 004-status-taxonomy-design-and-sch

## Step 1: Spec-Reviewer Review - Iteration 1 - 2026-03-01T16:55:00+08:00

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Needs Revision

**Issues:**
- [blocker] [assumptions] OQ-1, OQ-2, OQ-3 unresolved — affect schema design; must be firm decisions not recommendations
  Suggestion: Resolve all three OQs as firm decisions with rationale
- [blocker] [testability] AC-6 row cardinality undefined — `started`/`completed` semantics unclear for single-row model
  Suggestion: After resolving OQ-2, revise AC-6 to define row semantics
- [blocker] [traceability] AC-7 maps only 5 fields — real .meta.json has 15+ fields including design.stages.*, project_id, branch, etc.
  Suggestion: Enumerate ALL .meta.json fields with disposition
- [blocker] [clarity] AC-2/AC-6 NULL handling ambiguous — CHECK constraint with NULL needs explicit treatment
  Suggestion: Explicitly state whether workflow_phase is nullable or uses sentinel value
- [warning] [testability] AC-4 event vocabulary incomplete — missing phase_complete, phase_blocked, cancelled, etc.
  Suggestion: Enumerate complete list of workflow events that trigger kanban_column changes
- [warning] [assumptions] AC-6 FK provisional note missing — UUID migration may change PK
  Suggestion: Add explicit note about FK being based on current schema v1
- [warning] [scope] AC-7 status→kanban_column mapping rules undefined
  Suggestion: Add explicit mapping: planned→backlog, active→wip, completed→completed, abandoned→completed
- [warning] [testability] AC-5 entity type defaults not specified
  Suggestion: Define expected behavior for each entity type explicitly
- [warning] [clarity] AC-3 naming inconsistency with PRD (WIP vs wip, agent review vs agent_review)
  Suggestion: Confirm lowercase underscore values are canonical; display labels are UI concern

**Changes Made:**
Revising spec to address all blockers and warnings.

---

## Step 1: Spec-Reviewer Review - Iteration 2 - 2026-03-01T17:15:00+08:00

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Needs Revision

**Issues:**
- [blocker] [traceability] AC-7 missing `backlog_source` field — at least 5 features use it; provenance lineage from backlog items to features
  Suggestion: Add row with disposition (stays in .meta.json or maps to entities)
- [blocker] [traceability] AC-7 missing per-phase review sub-fields — `taskReview.*`, `chainReview.*`, `reviewIterations`, `approved`, `phases.finish.status` present in real .meta.json data
  Suggestion: Add explicit rows for all per-phase review sub-structures, deferred to feature 008
- [warning] [testability] Abandoned vs completed state indistinguishable — both map to kanban_column=completed, no explicit mechanism to tell them apart
  Suggestion: Add inference rule or explicit column for terminal disposition
- [warning] [assumptions] Per-entity-type kanban column restrictions not enforceable by DDL — CHECK constraints cannot reference entity_type
  Suggestion: Explicitly state enforcement layer (application-level via feature 008)
- [warning] [clarity] AC-4 phase_complete target "or remains" is ambiguous
  Suggestion: Replace with explicit rules for auto-start vs await scenarios
- [warning] [testability] AC-8 invalid scenarios lack enforcement layer specification
  Suggestion: Specify CHECK constraint vs trigger vs application validation for each scenario

**Changes Made:**
Revising spec to address all blockers and warnings.

---

## Step 1: Spec-Reviewer Review - Iteration 3 - 2026-03-01T17:30:00+08:00

**Reviewer:** spec-reviewer (skeptic)
**Decision:** Approved with warnings

**Issues:**
- [warning] [clarity] AC-8 scenarios #3 and #6 show identical column values with opposite validity — readability concern
  Suggestion: Add cross-reference parenthetical to scenario #3
- [warning] [assumptions] AC-4 phase_complete event precedence for finish phase unstated
  Suggestion: Add note that finish phase completion triggers feature_completed instead
- [suggestion] [clarity] Abandoned inference rule not SQL-safe for NULL workflow_phase
  Suggestion: Use (workflow_phase IS NULL OR workflow_phase != finish)

**Changes Made:**
Addressing 2 warnings and 1 suggestion for strict threshold compliance.

---

## Design Review - Iteration 1 - 2026-03-01T18:40:00+08:00

**Reviewer:** design-reviewer (skeptic)
**Decision:** Needs Revision

**Issues:**
- [warning] [completeness] FK has no ON DELETE clause — implicit RESTRICT behavior not documented
  Suggestion: Add a comment in the DDL or a note in the ADR acknowledging the implicit ON DELETE RESTRICT behavior
- [warning] [completeness] `mode` column has no CHECK constraint despite TD-2 rationale applying
  Suggestion: Either add CHECK(mode IN ('standard', 'full') OR mode IS NULL) or explain why mode is unconstrained
- [warning] [consistency] Ambiguity about what feature 004 delivers — ADR only vs ADR + Python code
  Suggestion: Clarify that feature 004 delivers ONLY the ADR document
- [warning] [assumptions] "workflow_phase as source of truth" claim not expressed in schema
  Suggestion: Add a note stating primacy is an application-level invariant

**Changes Made:**
Addressing all 4 warnings: added ON DELETE RESTRICT comment to DDL, added CHECK constraint for mode, clarified deliverable boundary in Component 2 and Architecture Overview, added workflow_phase primacy note to design principles.

---

## Design Review - Iteration 2 - 2026-03-01T18:45:00+08:00

**Reviewer:** design-reviewer (skeptic)
**Decision:** Approved

**Issues:**
- [suggestion] [consistency] Component 2 Outputs line still reads as Python function output
  Suggestion: Rephrase to "DDL content specifying the migration"
- [suggestion] [completeness] Components 5-6 don't reproduce spec tables inline
  Suggestion: Add note or reproduce tables for self-containment

**Changes Made:**
No changes needed — zero blockers and zero warnings. PASS.

---

## Handoff Review - Iteration 1 - 2026-03-01T18:50:00+08:00

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Needs Revision

**Issues:**
- [warning] Component 2 Outputs line names a Python function, creating momentary ambiguity about what feature 004 delivers
  Suggestion: Change to "DDL content embedded in ADR document (Python migration function is feature 005)"
- [suggestion] Components 5-6 don't embed full tables from AC-4 and AC-7 inline
  Suggestion: Embed complete tables for self-containment

**Changes Made:**
Addressing 1 warning: rephrased Component 2 Outputs to remove Python function reference.

---

## Step 2: Phase Review - Iteration 1 - 2026-03-01T17:45:00+08:00

**Reviewer:** phase-reviewer (gatekeeper)
**Decision:** Approved with warnings

**Issues:**
- [warning] AC-4 phase_complete does not define what constitutes auto-start vs human-decision pause
  Suggestion: Enumerate which phases auto-start or state that all phases auto-start
- [warning] AC-5/AC-6 DDL allows all 8 kanban values for all entity types without explicit acknowledgment
  Suggestion: State that DDL intentionally allows all values and restriction is delegated to feature 008
- [suggestion] skippedPhases intentionally absent from AC-6 schema not stated
  Suggestion: Add note confirming skipped_phases is feature 008's responsibility

**Changes Made:**
Addressing 2 warnings and 1 suggestion.

---
